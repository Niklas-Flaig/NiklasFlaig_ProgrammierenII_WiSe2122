<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8">
    <title>Chat</title>
    <link rel="stylesheet" href="./styles/style.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
  </head>
  <body>
    <div id="vue">
      <!-- loginScreen -->
      <div id="logInScreen" class="screen" v-if="currentMode === 'logIn'">
        <div v-on:click="submitNiklasFlaigLogin()"> <!-- this button is temporary -->
          <h2 class="heading">Log in!</h2>
        </div>
        <div class="inputs">
          <label>
            UserName:
            <input type="text" v-model="userName" placeholder="Enter Username..."/>
          </label>
          <label>
            PassWord:
            <input type="text" v-model="password" placeholder="Enter PassWord..."/>
          </label>
          <button v-on:click="submitLogin()">Enter</button>
          <a v-on:click="changeMode('register')">register</a>
        </div>
      </div>

      <!-- register screen -->
      <div id="registerScreen" class="screen" v-if="currentMode === 'register'">
        <h2 class="heading">Create a new account!</h2>
        <div class="inputs">
          <label>
            UserName:
            <input type="text" v-model="userName" placeholder="Enter Username..."/>
          </label>
          <label>
            PassWord:
            <input type="text" v-model="password" placeholder="Enter Password..."/>
          </label>
          <label>
            PassWord (repeat):
            <input type="text" v-model="repeatPassword" placeholder="Repeat Password..."/>
          </label>
          <button v-on:click="submitRegister()">Enter</button>
          <a v-on:click="changeMode('logIn')">Already have an account?</a>
        </div>
      </div>
      
      <div id="chat" class="screen" v-if="currentMode === 'chat'">
        <!-- chat/group selection -->
        <div id="chatSelectSurface" class="surface">
          <button :id="chat.getChatID()" class="chatTo" v-for="chat in clientChats" v-on:click="switchChat(chat.chatID)">
            <h4 class="chatName"> 
              {{ chat.getChatName() }}
            </h4>
            <div class="lastMessage" class="sendtBy_You">
              {{ chat.getLastMessageText() }}
            </div>
          </button>
          <!-- add a new chat -->
          <button v-on:click="changeMode('createChat')">add chat</button>
        </div>


        <!-- the in Chat Surface with messages -->
        <div id="inChatSurface" class="surface">
          <div id="chatHistory" v-if="currentChat.history.length > 0">
            <!-- creation of the messages -->
            <div v-for="message in currentChat.history" v-bind:class=message.getSenderClass()>
              <div class="sender" v-if="">{{ message.getSenderName() }}</div>
              <div class="content">{{ message.getContent() }}</div>
              <div class="time">{{ message.getTimeToDisplay() }}</div>
            </div>
          </div>
          <div id="chatHistoryEmpty" v-else>
            <h3 class="heading">There are no messages Yet</h3>
          </div>
          <div id="chatInput" v-if="currentChat.chatType !== ''">
            <input type="text" id="textMessage_TextInput" v-model="newMessageText" v-on:keyup.enter="sendMessage" placeholder="Enter message...">
            <button id="sendMessage_Button" v-on:click="sendMessage()">send</button>
          </div>
        </div>

        <div id="inChatSurfacePlaceholder" class="surface" v-if="currentMode === 0">
            <h2>Enter a chat!!</h2>
        </div>

      </div>

      <!-- create a new groupChat -->
      <div class="screen" v-if="currentMode === 'createGroupChat'">
        <h2 class="heading">Create a new GroupChat!</h2>
        <div class="inputs">
          <div class="tabMenu">
            <div v-on:click="changeMode('createChat')">pToPChat</div>
            <div>groupChat</div>
          </div>
          <label>
            GroupName:
            <input type="text" v-model="newGroupChat.name" placeholder="Enter ChatName..."/>
          </label>
          <label>
            UserNames:
            <input type="text" v-model="newGroupChat.userNames" v-on:keyup.enter="requestChatGeneration('pToPChat')" placeholder="User1, User2, ..."/>
          </label>
          <div id="newChatParticipants">
            <div v-for="user in newGroupChat.users">
              {{ user.userName }}
            </div>
          </div>
          <button v-on:click="requestChatGeneration('groupChat')">create chat</button>
        </div>
      </div>

      <!-- create a new PtoPChat -->
      <div class="screen" v-if="currentMode === 'createChat'">
        <h2 class="heading">Create a new Chat!</h2>
        <!-- Chat-Type selection -->
        <div class="inputs">
          <div class="tabMenu">
            <div>pToPChat</div>
            <div v-on:click="changeMode('createGroupChat')">groupChat</div>
          </div>
          <label>
            UserName:
            <input type="text" v-model="newChat.userName" v-on:keyup.enter="requestChatGeneration('pToPChat')" placeholder="Enter UserName..."/>
          </label>
          <button v-on:click="requestChatGeneration('pToPChat')">create chat</button>
        </div>
      </div>
      
    </div>
    <script src=./javaScripts/classes.js></script>
    <script src="https://cdn.socket.io/4.3.0/socket.io.js"></script>
    <script src=./javaScripts/vue.js></script>
    <script src=./javaScripts/socket.js></script>
  </body>
</html>
